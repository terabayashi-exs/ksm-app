# KSM-App プロジェクト仕様書
## PK選手権大会運営システム - 完全実装ガイド

> **最終更新**: 2025年12月12日
> **実装完成度**: 95%（プロダクションレディ）
> **運用実績**: 富山県PK選手権大会2025（16チーム・160+選手）

## 🎯 プロジェクトの目的

「PK選手権大会」を運営するためのWebアプリケーションを構築します。
主な用途は以下の通りです：

- 大会情報の登録（名称、日程、会場など）
- チームや選手の登録
- 試合スケジュールの作成（予選・決勝）
- 結果の入力と表示
- 一般ユーザー向けの結果公開ページ
- 管理者向けの結果公開ページ

## 📚 ドキュメント構成

このプロジェクトの詳細仕様は、以下のドキュメントに分割されています：

### 技術仕様
- **[アーキテクチャ設計](./docs/specs/architecture.md)** - 使用技術スタック、コーディング規約、ファイル構成
- **[データベース設計](./docs/specs/database.md)** - テーブル設計、制約、タイムゾーン仕様
- **[実装状況](./docs/specs/implementation-status.md)** - 実装完了タスク、運用実績、将来計画

### 機能仕様
- **[実装済み機能一覧](./docs/features/implemented-features.md)** - 全機能の詳細仕様（順位表、試合管理、辞退管理など）

### 開発ガイド
- **[開発環境セットアップ](./docs/guides/development.md)** - 環境設定、開発コマンド、セットアップ手順

## 🚀 クイックスタート

### 1. 依存関係のインストール
```bash
npm install
```

### 2. 環境変数の設定
`.env.local`ファイルを作成（詳細は[開発ガイド](./docs/guides/development.md)参照）

### 3. データベースの初期化
```bash
npm run db:generate  # DDL生成
npm run db:migrate   # テーブル作成
npm run db:seed-master  # マスターデータ投入
```

### 4. 開発サーバー起動
```bash
npm run dev
```

## 📊 プロジェクト概要

### 主要機能（実装完了）

#### 🔐 認証・権限管理
- NextAuth.js v4によるセッション管理
- 管理者・チーム代表者のロール管理
- JWT審判アクセストークン

#### 🏆 大会管理
- 大会CRUD（作成・編集・削除・一覧）
- 動的ステータス管理（日付ベース自動判定）
- 複数大会同時開催対応
- 公開設定・募集期間管理

#### 👥 チーム・選手管理
- 複数チーム参加機能（同一マスターから複数エントリー）
- CSV一括登録（管理者代行）
- 登録種別管理（自己登録・代行登録の区別）
- 大会別選手アサイン

#### 🎮 試合管理・結果入力
- SSEによるリアルタイム監視
- QR認証審判システム
- 2段階確定プロセス（結果入力→管理者確定）
- ブロック別管理（予選A,B,C,D + 決勝トーナメント）

#### 📈 順位表・戦績表
- 事前計算順位表（JSON形式高速表示）
- 手動順位調整機能
- 決勝トーナメント順位自動計算
- 対戦結果マトリックス表示

#### 🚫 辞退管理
- 影響度自動評価
- 承認・却下処理
- 統計ダッシュボード

#### 🗄️ アーカイブシステム
- 大会終了時のUI状態完全保存
- バージョン管理システム
- 時点凍結による表示一貫性保証

### 技術スタック概要

- **フレームワーク**: Next.js 15.5.7 (App Router) + React 19.0.0
- **言語**: TypeScript 5.x（型安全性100%）
- **UI**: Tailwind CSS 4.x + shadcn/ui
- **データベース**: Turso (リモートSQLite)
- **認証**: NextAuth.js 4.24.11
- **デプロイ**: Vercel
- **ストレージ**: Vercel Blob Storage
- **フォーム**: React Hook Form 7.61.1 + Zod 4.0.14

## 🔍 設計方針と制約

- 複数大会の同時開催に対応（大会IDベースで全体を構成）
- チーム・選手は大会単位で分離
- 管理側はPC、使用側はスマートフォンを想定（レスポンシブ対応）
- 日本標準時（JST = UTC+9）を統一使用

## 📈 運用実績

### 富山県PK選手権大会2025
- **参加チーム**: 16チーム（実データ）
- **登録選手**: 160+名（実データ）
- **試合数**: 64試合（予選48 + 決勝16）
- **稼働率**: 99.9%（24時間連続稼働）
- **レスポンス時間**: 平均50ms以下

### システム規模
- **データベース**: 28テーブル・3000+レコード
- **API**: 100+エンドポイント
- **ページ**: 50+画面
- **処理実績**: 1日1000+リクエスト

## 💬 サポート・問い合わせ

- **技術仕様**: 各種ドキュメント参照
- **機能詳細**: [実装済み機能一覧](./docs/features/implemented-features.md)
- **開発方法**: [開発ガイド](./docs/guides/development.md)

---

**プロジェクトステータス**: プロダクションレディ（本番運用可能）
